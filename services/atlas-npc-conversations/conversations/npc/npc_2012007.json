{
  "npcId": 2012007,
  "name": "Rinz the Assistant - Orbis Random Hair/Hair Color Change",
  "startState": "welcome",
  "states": [
    {
      "id": "welcome",
      "type": "listSelection",
      "listSelection": {
        "title": "I'm Rinz, the assistant. Do you have #b#t5154000##k, #b#t5150004##k, #b#t5150013##k or #b#t5151004##k with you? If so, what do you think about letting me take care of your hairdo? What do you want to do with your hair?",
        "choices": [
          { "text": "Haircut: #i5154000##t5154000#", "nextState": "generateDrtStyles", "context": { "couponType": "drt" } },
          { "text": "Haircut: #i5150004##t5150004#", "nextState": "generateRegStyles", "context": { "couponType": "reg" } },
          { "text": "Haircut: #i5150013##t5150013#", "nextState": "generateExpStyles", "context": { "couponType": "exp" } },
          { "text": "Dye your hair: #i5151004##t5151004#", "nextState": "generateHairColors", "context": { "couponType": "color" } },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "generateDrtStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_styles",
            "params": {
              "baseStyles": "30030,30020,30000,30270,30230,31040,31000,31250,31220,31260",
              "genderFilter": "true",
              "preserveColor": "true",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "generatedHairs"
            }
          }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "confirmDrt" }
        ]
      }
    },
    {
      "id": "confirmDrt",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use the DRT coupon your hair will change RANDOMLY with a chance to obtain the basic styles that I came up with. Are you going to use #b#t5154000##k and really change your hairstyle?",
        "choices": [
          { "text": "Yes", "nextState": "checkDrtCoupon" },
          { "text": "No", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "checkDrtCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "item", "operator": ">=", "value": "1", "referenceId": "5154000" }
            ],
            "nextState": "executeDrtHaircut"
          },
          { "conditions": [], "nextState": "noDrtCoupon" }
        ]
      }
    },
    {
      "id": "executeDrtHaircut",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          { "type": "destroy_item", "params": { "itemId": "5154000", "quantity": "1" } },
          { "type": "local:select_random_cosmetic", "params": { "stylesContextKey": "generatedHairs", "outputContextKey": "selectedHair" } },
          { "type": "change_hair", "params": { "styleId": "{context.selectedHair}" } }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "haircutSuccess" }
        ]
      }
    },
    {
      "id": "noDrtCoupon",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't give you a haircut without it. I'm sorry...",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "generateRegStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_styles",
            "params": {
              "baseStyles": "30230,30260,30280,30340,30490,30530,30630,30740,31110,31220,31230,31630,31650,31710,31790,31890,31930",
              "genderFilter": "true",
              "preserveColor": "true",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "generatedHairs"
            }
          }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "confirmReg" }
        ]
      }
    },
    {
      "id": "confirmReg",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use the REG coupon your hair will change RANDOMLY. Are you going to use #b#t5150004##k and really change your hairstyle?",
        "choices": [
          { "text": "Yes", "nextState": "checkRegCoupon" },
          { "text": "No", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "checkRegCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "item", "operator": ">=", "value": "1", "referenceId": "5150004" }
            ],
            "nextState": "executeRegHaircut"
          },
          { "conditions": [], "nextState": "noRegCoupon" }
        ]
      }
    },
    {
      "id": "executeRegHaircut",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          { "type": "destroy_item", "params": { "itemId": "5150004", "quantity": "1" } },
          { "type": "local:select_random_cosmetic", "params": { "stylesContextKey": "generatedHairs", "outputContextKey": "selectedHair" } },
          { "type": "change_hair", "params": { "styleId": "{context.selectedHair}" } }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "haircutSuccess" }
        ]
      }
    },
    {
      "id": "noRegCoupon",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't give you a haircut without it. I'm sorry...",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "generateExpStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_styles",
            "params": {
              "baseStyles": "30230,30280,30340,30490,30530,30740,31110,31220,31230,31710,31790,31890,31930",
              "genderFilter": "true",
              "preserveColor": "true",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "generatedHairs"
            }
          }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "confirmExp" }
        ]
      }
    },
    {
      "id": "confirmExp",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use the EXP coupon your hair will change RANDOMLY with a chance to obtain a new experimental style that I came up with. Are you going to use #b#t5150013##k and really change your hairstyle?",
        "choices": [
          { "text": "Yes", "nextState": "checkExpCoupon" },
          { "text": "No", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "checkExpCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "item", "operator": ">=", "value": "1", "referenceId": "5150013" }
            ],
            "nextState": "executeExpHaircut"
          },
          { "conditions": [], "nextState": "noExpCoupon" }
        ]
      }
    },
    {
      "id": "executeExpHaircut",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          { "type": "destroy_item", "params": { "itemId": "5150013", "quantity": "1" } },
          { "type": "local:select_random_cosmetic", "params": { "stylesContextKey": "generatedHairs", "outputContextKey": "selectedHair" } },
          { "type": "change_hair", "params": { "styleId": "{context.selectedHair}" } }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "haircutSuccess" }
        ]
      }
    },
    {
      "id": "noExpCoupon",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't give you a haircut without it. I'm sorry...",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "generateHairColors",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_colors",
            "params": {
              "colors": "0,1,2,3,4,5,6,7",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "generatedColors"
            }
          }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "confirmColor" }
        ]
      }
    },
    {
      "id": "confirmColor",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use a regular coupon your hair color will change RANDOMLY. Do you still want to use #b#t5151004##k and change it up?",
        "choices": [
          { "text": "Yes", "nextState": "checkColorCoupon" },
          { "text": "No", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "checkColorCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "item", "operator": ">=", "value": "1", "referenceId": "5151004" }
            ],
            "nextState": "executeColorChange"
          },
          { "conditions": [], "nextState": "noColorCoupon" }
        ]
      }
    },
    {
      "id": "executeColorChange",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          { "type": "destroy_item", "params": { "itemId": "5151004", "quantity": "1" } },
          { "type": "local:select_random_cosmetic", "params": { "stylesContextKey": "generatedColors", "outputContextKey": "selectedHair" } },
          { "type": "change_hair", "params": { "styleId": "{context.selectedHair}" } }
        ],
        "outcomes": [
          { "conditions": [], "nextState": "haircolorSuccess" }
        ]
      }
    },
    {
      "id": "noColorCoupon",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't dye your hair without it. I'm sorry...",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "haircutSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved hairstyle!",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "haircolorSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved haircolor!",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    }
  ]
}
