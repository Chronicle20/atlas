{
  "npcId": 2090005,
  "startState": "checkLocation",
  "states": [
    {
      "id": "checkLocation",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "mapId", "operator": "=", "value": "251000000" }
            ],
            "nextState": "herbTownDirectOffer"
          },
          {
            "conditions": [
              { "type": "mapId", "operator": "=", "value": "250000100" }
            ],
            "nextState": "muLungMenu"
          },
          {
            "conditions": [
              { "type": "mapId", "operator": "=", "value": "200000141" }
            ],
            "nextState": "orbisMenu"
          },
          {
            "conditions": [],
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "herbTownDirectOffer",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "Hello there. How's the traveling so far? I've been transporting other travelers like you to #bMu Lung#k in no time, and... are you interested? It's not as stable as the ship, so you'll have to hold on tight, but i can get there much faster than the ship. I'll take you there as long as you pay #b500 mesos#k.",
        "choices": [
          { "text": "Yes", "nextState": "herbTownCheckMeso", "context": { "destination": "250000100", "cost": "500" } },
          { "text": "No", "nextState": "decline" },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "muLungMenu",
      "type": "listSelection",
      "listSelection": {
        "title": "Hello there. How's the traveling so far? I understand that walking on two legs is much harder to cover ground compared to someone like me that can navigate the skies. I've been transporting other travelers like you to other regions in no time, and... are you interested? If so, then select the town you'd like yo head to.",
        "choices": [
          { "text": "Orbis(1500 mesos)", "nextState": "confirmOrbisTrip" },
          { "text": "Herb Town(500 mesos)", "nextState": "confirmTrip", "context": { "destination": "251000000", "cost": "500", "destinationName": "Herb Town" } },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "orbisMenu",
      "type": "listSelection",
      "listSelection": {
        "title": "Hello there. How's the traveling so far? I've been transporting other travelers like you to other regions in no time, and... are you interested? If so, then select the town you'd like to head to.",
        "choices": [
          { "text": "Mu Lung(1500 mesos)", "nextState": "confirmMuLungTrip" },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "confirmOrbisTrip",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "Will you move to #bOrbis#k now? If you have #b1500 mesos#k, I'll take you there right now.",
        "choices": [
          { "text": "Yes", "nextState": "checkOrbisMeso" },
          { "text": "No", "nextState": "decline" },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "checkOrbisMeso",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "meso", "operator": "<", "value": "1500" }
            ],
            "nextState": "insufficientMeso"
          },
          {
            "conditions": [],
            "nextState": "deductOrbisMeso"
          }
        ]
      }
    },
    {
      "id": "deductOrbisMeso",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "award_mesos",
            "params": { "amount": "-1500" }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "startOrbisTransport"
          }
        ]
      }
    },
    {
      "id": "startOrbisTransport",
      "type": "transportAction",
      "transportAction": {
        "routeName": "hak-to-orbis",
        "failureState": "transportFailed",
        "capacityFullState": "transportCapacityFull",
        "alreadyInTransitState": "transportAlreadyInTransit",
        "routeNotFoundState": "transportFailed",
        "serviceErrorState": "transportFailed"
      }
    },
    {
      "id": "confirmMuLungTrip",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "Will you move to #bMu Lung#k now? If you have #b1500 mesos#k, I'll take you there right now.",
        "choices": [
          { "text": "Yes", "nextState": "checkMuLungMeso" },
          { "text": "No", "nextState": "decline" },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "checkMuLungMeso",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "meso", "operator": "<", "value": "1500" }
            ],
            "nextState": "insufficientMeso"
          },
          {
            "conditions": [],
            "nextState": "deductMuLungMeso"
          }
        ]
      }
    },
    {
      "id": "deductMuLungMeso",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "award_mesos",
            "params": { "amount": "-1500" }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "startMuLungTransport"
          }
        ]
      }
    },
    {
      "id": "startMuLungTransport",
      "type": "transportAction",
      "transportAction": {
        "routeName": "hak-to-mu-lung",
        "failureState": "transportFailed",
        "capacityFullState": "transportCapacityFull",
        "alreadyInTransitState": "transportAlreadyInTransit",
        "routeNotFoundState": "transportFailed",
        "serviceErrorState": "transportFailed"
      }
    },
    {
      "id": "confirmTrip",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "Will you move to #b{context.destinationName}#k now? If you have #b{context.cost} mesos#k, I'll take you there right now.",
        "choices": [
          { "text": "Yes", "nextState": "checkMeso" },
          { "text": "No", "nextState": "decline" },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "herbTownCheckMeso",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "meso", "operator": "<", "value": "{context.cost}" }
            ],
            "nextState": "insufficientMeso"
          },
          {
            "conditions": [],
            "nextState": "performWarp"
          }
        ]
      }
    },
    {
      "id": "checkMeso",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              { "type": "meso", "operator": "<", "value": "{context.cost}" }
            ],
            "nextState": "insufficientMeso"
          },
          {
            "conditions": [],
            "nextState": "performWarp"
          }
        ]
      }
    },
    {
      "id": "performWarp",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "award_mesos",
            "params": { "amount": "-{context.cost}" }
          },
          {
            "type": "warp_to_map",
            "params": { "mapId": "{context.destination}", "portalId": "0" }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "decline",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendNext",
        "text": "OK. If you ever change your mind, please let me know.",
        "choices": [
          { "text": "Next", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "insufficientMeso",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendNext",
        "text": "Are you sure you have enough mesos?",
        "choices": [
          { "text": "Next", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "transportFailed",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Sorry, I'm unable to fly right now. Please try again later.",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "transportCapacityFull",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Sorry, I'm currently carrying another passenger. Please wait a moment and try again.",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    },
    {
      "id": "transportAlreadyInTransit",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "You seem to already be on a transport. Please wait until you arrive at your destination.",
        "choices": [
          { "text": "Ok", "nextState": null },
          { "text": "Exit", "nextState": null }
        ]
      }
    }
  ]
}
