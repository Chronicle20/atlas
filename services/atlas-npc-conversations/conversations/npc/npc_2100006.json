{
  "npcId": 2100006,
  "startState": "mainMenu",
  "states": [
    {
      "id": "mainMenu",
      "type": "listSelection",
      "listSelection": {
        "title": "Hahaha... it takes a lot of style and flair for someone to pay attention to his or her hairsyle in a desert. Someone like you...If you have #bAriant hair style coupon(VIP)#k or #bAriant hair color coupon(VIP)#k, I'll give your hair a fresh new look.",
        "choices": [
          {
            "text": "Haircut: #i5150027##t5150027#",
            "nextState": "generateHairStyles",
            "context": {
              "beauty": "1"
            }
          },
          {
            "text": "Dye your hair: #i5151022##t5151022#",
            "nextState": "generateHairColors",
            "context": {
              "beauty": "2"
            }
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "generateHairStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_styles",
            "params": {
              "baseStyles": "30150,30170,30180,30320,30330,30410,30460,30820,30900,31040,31090,31190,31330,31340,31400,31420,31620,31660",
              "genderFilter": "true",
              "preserveColor": "true",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "generatedStyles"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "selectHairStyle"
          }
        ]
      }
    },
    {
      "id": "selectHairStyle",
      "type": "askStyle",
      "askStyle": {
        "text": "Hahaha~all you need is #bAriant hair style coupon(VIP)#k to change up your hairstyle. Choose the new style, and let me do the rest.",
        "stylesContextKey": "generatedStyles",
        "contextKey": "selectedHair",
        "nextState": "checkHaircutCoupon"
      }
    },
    {
      "id": "checkHaircutCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              {
                "type": "item",
                "operator": ">=",
                "value": "1",
                "referenceId": "5150027"
              }
            ],
            "nextState": "performHaircut"
          },
          {
            "conditions": [],
            "nextState": "noCouponHaircut"
          }
        ]
      }
    },
    {
      "id": "performHaircut",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "destroy_item",
            "params": {
              "itemId": "5150027",
              "quantity": "1"
            }
          },
          {
            "type": "change_hair",
            "params": {
              "styleId": "{context.selectedHair}"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "haircutSuccess"
          }
        ]
      }
    },
    {
      "id": "haircutSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved hairstyle!",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "noCouponHaircut",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendNext",
        "text": "I thought I told you, you need the coupon in order for me to work magic on your hair check again.",
        "choices": [
          {
            "text": "Next",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "generateHairColors",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_colors",
            "params": {
              "colors": "0,1,2,3,4,5,6,7",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "generatedColors"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "selectHairColor"
          }
        ]
      }
    },
    {
      "id": "selectHairColor",
      "type": "askStyle",
      "askStyle": {
        "text": "Every once in a while, it doesn't hurt to change up your hair color... it's fun. Allow me, the great Mazra, to dye your hair, so you just bring me #bAriant hair color coupon(VIP)#k, and choose your new hair color.",
        "stylesContextKey": "generatedColors",
        "contextKey": "selectedHair",
        "nextState": "checkDyeCoupon"
      }
    },
    {
      "id": "checkDyeCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              {
                "type": "item",
                "operator": ">=",
                "value": "1",
                "referenceId": "5151022"
              }
            ],
            "nextState": "performDye"
          },
          {
            "conditions": [],
            "nextState": "noCouponDye"
          }
        ]
      }
    },
    {
      "id": "performDye",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "destroy_item",
            "params": {
              "itemId": "5151022",
              "quantity": "1"
            }
          },
          {
            "type": "change_hair",
            "params": {
              "styleId": "{context.selectedHair}"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "dyeSuccess"
          }
        ]
      }
    },
    {
      "id": "dyeSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved haircolor!",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "noCouponDye",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendNext",
        "text": "I thought I told you, you need the coupon in order for me to work magic on your hair check again.",
        "choices": [
          {
            "text": "Next",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    }
  ]
}
