{
  "npcId": 9201016,
  "startState": "welcome",
  "states": [
    {
      "id": "welcome",
      "type": "listSelection",
      "listSelection": {
        "title": "I'm Salon Seamus. If you have #b#t5150019##k or #b#t5151016##k by any chance, then how about letting me change your hairdo?",
        "choices": [
          {
            "text": "Haircut: #i5150019##t5150019#",
            "nextState": "prepareHaircutStyles"
          },
          {
            "text": "Dye your hair: #i5151016##t5151016#",
            "nextState": "prepareHairColorStyles"
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "prepareHaircutStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_styles",
            "params": {
              "baseStyles": "30000,30020,30110,30130,30160,30190,30240,30270,30430,31000,31030,31050,31070,31090,31150,31310,31910,34010",
              "genderFilter": "true",
              "preserveColor": "true",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "haircutStyles"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "confirmHaircut"
          }
        ]
      }
    },
    {
      "id": "confirmHaircut",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use the EXP coupon your hair will change RANDOMLY with a chance to obtain a new experimental style that even you didn't think was possible. Are you going to use #b#t5150019##k and really change your hairstyle?",
        "choices": [
          {
            "text": "Yes",
            "nextState": "checkHaircutCoupon"
          },
          {
            "text": "No",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "checkHaircutCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              {
                "type": "item",
                "operator": ">=",
                "value": "1",
                "referenceId": "5150019"
              }
            ],
            "nextState": "applyRandomHaircut"
          },
          {
            "conditions": [],
            "nextState": "noHaircutCoupon"
          }
        ]
      }
    },
    {
      "id": "applyRandomHaircut",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:select_random_cosmetic",
            "params": {
              "stylesContextKey": "haircutStyles",
              "outputContextKey": "selectedHair"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "performHaircutChange"
          }
        ]
      }
    },
    {
      "id": "performHaircutChange",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "destroy_item",
            "params": {
              "itemId": "5150019",
              "quantity": "1"
            }
          },
          {
            "type": "change_hair",
            "params": {
              "styleId": "{context.selectedHair}"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "haircutSuccess"
          }
        ]
      }
    },
    {
      "id": "haircutSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved hairstyle!",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "noHaircutCoupon",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't give you a haircut without it. I'm sorry...",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "prepareHairColorStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_colors",
            "params": {
              "colors": "0,1,2,3,4,5,6,7",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "hairColorStyles"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "confirmHairColor"
          }
        ]
      }
    },
    {
      "id": "confirmHairColor",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use a regular coupon your hair will change RANDOMLY. Do you still want to use #b#t5151016##k and change it up?",
        "choices": [
          {
            "text": "Yes",
            "nextState": "checkHairColorCoupon"
          },
          {
            "text": "No",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "checkHairColorCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [],
        "outcomes": [
          {
            "conditions": [
              {
                "type": "item",
                "operator": ">=",
                "value": "1",
                "referenceId": "5151016"
              }
            ],
            "nextState": "applyRandomHairColor"
          },
          {
            "conditions": [],
            "nextState": "noHairColorCoupon"
          }
        ]
      }
    },
    {
      "id": "applyRandomHairColor",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:select_random_cosmetic",
            "params": {
              "stylesContextKey": "hairColorStyles",
              "outputContextKey": "selectedColor"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "performHairColorChange"
          }
        ]
      }
    },
    {
      "id": "performHairColorChange",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "destroy_item",
            "params": {
              "itemId": "5151016",
              "quantity": "1"
            }
          },
          {
            "type": "change_hair",
            "params": {
              "styleId": "{context.selectedColor}"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "hairColorSuccess"
          }
        ]
      }
    },
    {
      "id": "hairColorSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved haircolor!",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "noHairColorCoupon",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't dye your hair without it. I'm sorry...",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    }
  ]
}
