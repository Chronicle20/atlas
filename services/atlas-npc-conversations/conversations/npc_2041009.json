{
  "npcId": 2041009,
  "startState": "askService",
  "states": [
    {
      "id": "askService",
      "type": "listSelection",
      "listSelection": {
        "title": "Hi, I'm the assistant here. Don't worry, I'm plenty good enough for this. If you have #b#t5150006##k, #b#t5150012##k or #b#t5151006##k by any chance, then allow me to take care of the rest, alright?",
        "choices": [
          {
            "text": "Haircut: #i5150006##t5150006#",
            "nextState": "prepareRegHairStyles"
          },
          {
            "text": "Haircut: #i5150012##t5150012#",
            "nextState": "prepareExpHairStyles"
          },
          {
            "text": "Dye your hair: #i5151006##t5151006#",
            "nextState": "prepareHairColors"
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "prepareRegHairStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_styles",
            "params": {
              "baseStyles": "30190,30220,30250,30540,30610,30620,30640,30650,30660,30840,30870,30940,30990,31170,31270,31290,31510,31540,31550,31600,31640,31680,31810,31830,31840,31870",
              "genderFilter": "true",
              "preserveColor": "true",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "regHairStyles"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "confirmRegHaircut"
          }
        ]
      }
    },
    {
      "id": "confirmRegHaircut",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use the REG coupon your hair will change RANDOMLY with a chance to obtain a new experimental style that I came up with. Are you going to use #b#t5150012##k and really change your hairstyle?",
        "choices": [
          {
            "text": "Yes",
            "nextState": "checkRegCoupon"
          },
          {
            "text": "No",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "checkRegCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:select_random_cosmetic",
            "params": {
              "stylesContextKey": "regHairStyles",
              "outputContextKey": "selectedHair"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [
              {
                "type": "item",
                "operator": ">=",
                "value": "1",
                "referenceId": "5150006"
              }
            ],
            "nextState": "applyRegHaircut"
          },
          {
            "conditions": [],
            "nextState": "regHaircutFailure"
          }
        ]
      }
    },
    {
      "id": "applyRegHaircut",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "destroy_item",
            "params": {
              "itemId": "5150006",
              "quantity": "1"
            }
          },
          {
            "type": "change_hair",
            "params": {
              "styleId": "{context.selectedHair}"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "regHaircutSuccess"
          }
        ]
      }
    },
    {
      "id": "regHaircutSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved haircolor!",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "regHaircutFailure",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't dye your hair without it. I'm sorry...",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "prepareExpHairStyles",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_styles",
            "params": {
              "baseStyles": "30030,30190,30220,30250,30540,30610,30620,30640,30650,30660,30840,30990,31170,31270,31430,31510,31540,31550,31600,31680,31810,31830,31840,31870",
              "genderFilter": "true",
              "preserveColor": "true",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "expHairStyles"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "confirmExpHaircut"
          }
        ]
      }
    },
    {
      "id": "confirmExpHaircut",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use the EXP coupon your hair will change RANDOMLY with a chance to obtain a new experimental style that I came up with. Are you going to use #b#t5150012##k and really change your hairstyle?",
        "choices": [
          {
            "text": "Yes",
            "nextState": "checkExpCoupon"
          },
          {
            "text": "No",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "checkExpCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:select_random_cosmetic",
            "params": {
              "stylesContextKey": "expHairStyles",
              "outputContextKey": "selectedHair"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [
              {
                "type": "item",
                "operator": ">=",
                "value": "1",
                "referenceId": "5150012"
              }
            ],
            "nextState": "applyExpHaircut"
          },
          {
            "conditions": [],
            "nextState": "expHaircutFailure"
          }
        ]
      }
    },
    {
      "id": "applyExpHaircut",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "destroy_item",
            "params": {
              "itemId": "5150012",
              "quantity": "1"
            }
          },
          {
            "type": "change_hair",
            "params": {
              "styleId": "{context.selectedHair}"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "expHaircutSuccess"
          }
        ]
      }
    },
    {
      "id": "expHaircutSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved hairstyle!",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "expHaircutFailure",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't give you a haircut without it. I'm sorry...",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "prepareHairColors",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:generate_hair_colors",
            "params": {
              "colors": "0,1,2,3,4,5,6,7",
              "validateExists": "true",
              "excludeEquipped": "true",
              "outputContextKey": "hairColors"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "confirmHairDye"
          }
        ]
      }
    },
    {
      "id": "confirmHairDye",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendYesNo",
        "text": "If you use a regular coupon your hair will change RANDOMLY. Do you still want to use #b#t5151006##k and change it up?",
        "choices": [
          {
            "text": "Yes",
            "nextState": "checkHairDyeCoupon"
          },
          {
            "text": "No",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "checkHairDyeCoupon",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "local:select_random_cosmetic",
            "params": {
              "stylesContextKey": "hairColors",
              "outputContextKey": "selectedColor"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [
              {
                "type": "item",
                "operator": ">=",
                "value": "1",
                "referenceId": "5151006"
              }
            ],
            "nextState": "applyHairDye"
          },
          {
            "conditions": [],
            "nextState": "hairDyeFailure"
          }
        ]
      }
    },
    {
      "id": "applyHairDye",
      "type": "genericAction",
      "genericAction": {
        "operations": [
          {
            "type": "destroy_item",
            "params": {
              "itemId": "5151006",
              "quantity": "1"
            }
          },
          {
            "type": "change_hair",
            "params": {
              "styleId": "{context.selectedColor}"
            }
          }
        ],
        "outcomes": [
          {
            "conditions": [],
            "nextState": "hairDyeSuccess"
          }
        ]
      }
    },
    {
      "id": "hairDyeSuccess",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Enjoy your new and improved haircolor!",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    },
    {
      "id": "hairDyeFailure",
      "type": "dialogue",
      "dialogue": {
        "dialogueType": "sendOk",
        "text": "Hmmm...it looks like you don't have our designated coupon...I'm afraid I can't dye your hair without it. I'm sorry...",
        "choices": [
          {
            "text": "Ok",
            "nextState": null
          },
          {
            "text": "Exit",
            "nextState": null
          }
        ]
      }
    }
  ]
}
