{
  "questId": 1021,
  "npcId": 2000,
  "questName": "Roger's Apple",
  "startStateMachine": {
    "startState": "greeting",
    "states": [
      {
        "id": "greeting",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendNext",
          "text": "Hey, Man~ What's up? Haha! I am Roger who can teach you adorable new Maplers lots of information.",
          "choices": [
            {"text": "Next", "nextState": "motivation"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "motivation",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendNextPrev",
          "text": "You are asking who made me do this? Ahahahaha!\r\nMyself! I wanted to do this and just be kind to you new travellers.",
          "choices": [
            {"text": "Previous", "nextState": "greeting"},
            {"text": "Next", "nextState": "askAccept"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "askAccept",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendAcceptDecline",
          "text": "So..... Let me just do this for fun! Abaracadabra~!",
          "choices": [
            {"text": "Accept", "nextState": "checkHpAndGiveApple"},
            {"text": "Decline", "nextState": null},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "checkHpAndGiveApple",
        "type": "genericAction",
        "genericAction": {
          "operations": [],
          "outcomes": [
            {
              "conditions": [
                {"type": "hp", "operator": ">=", "value": "50"}
              ],
              "nextState": "setHpAndGiveApple"
            },
            {
              "conditions": [],
              "nextState": "checkHaveApple"
            }
          ]
        }
      },
      {
        "id": "setHpAndGiveApple",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "set_hp", "params": {"amount": "25"}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": "checkHaveApple"}
          ]
        }
      },
      {
        "id": "checkHaveApple",
        "type": "genericAction",
        "genericAction": {
          "operations": [],
          "outcomes": [
            {
              "conditions": [
                {"type": "item", "operator": ">=", "value": "1", "referenceId": "2010007"}
              ],
              "nextState": "startQuestAndExplain"
            },
            {
              "conditions": [],
              "nextState": "giveAppleAndStart"
            }
          ]
        }
      },
      {
        "id": "giveAppleAndStart",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "award_item", "params": {"itemId": "2010007", "quantity": "1"}},
            {"type": "start_quest", "params": {}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": "explanation"}
          ]
        }
      },
      {
        "id": "startQuestAndExplain",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "start_quest", "params": {}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": "explanation"}
          ]
        }
      },
      {
        "id": "explanation",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendNext",
          "text": "Surprised? If HP becomes 0, then you are in trouble. Now, I will give you #rRoger's Apple#k. Please take it. You will feel stronger. Open the Item window and double click to consume. Hey, it's very simple to open the Item window. Just press #bI#k on your keyboard.",
          "choices": [
            {"text": "Next", "nextState": "instructions"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "instructions",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendNextPrev",
          "text": "Please take all Roger's Apples that I gave you. You will be able to see the HP bar increasing. Please talk to me again when you recover your HP 100%.",
          "choices": [
            {"text": "Previous", "nextState": "explanation"},
            {"text": "Next", "nextState": "showTutorial"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "showTutorial",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "show_info", "params": {"path": "UI/tutorial.img/28"}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": null}
          ]
        }
      }
    ]
  },
  "endStateMachine": {
    "startState": "checkHpRecovered",
    "states": [
      {
        "id": "checkHpRecovered",
        "type": "genericAction",
        "genericAction": {
          "operations": [],
          "outcomes": [
            {
              "conditions": [
                {"type": "hp", "operator": "<", "value": "50"}
              ],
              "nextState": "notRecovered"
            },
            {
              "conditions": [],
              "nextState": "hotkeyExplanation"
            }
          ]
        }
      },
      {
        "id": "notRecovered",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendOk",
          "text": "Hey, your HP is not fully recovered yet. Did you take all the Roger's Apple that I gave you? Are you sure?",
          "choices": [
            {"text": "Ok", "nextState": null},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "hotkeyExplanation",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendNext",
          "text": "How easy is it to consume the item? Simple, right? You can set a #bhotkey#k on the right bottom slot. Haha you didn't know that! right? Oh, and if you are a beginner, HP will automatically recover itself as time goes by. Well it takes time but this is one of the strategies for the beginners.",
          "choices": [
            {"text": "Next", "nextState": "presentAnnouncement"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "presentAnnouncement",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendNextPrev",
          "text": "Alright! Now that you have learned alot, I will give you a present. This is a must for your travel in Maple World, so thank me! Please use this under emergency cases!",
          "choices": [
            {"text": "Previous", "nextState": "hotkeyExplanation"},
            {"text": "Next", "nextState": "farewell"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "farewell",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendNextPrev",
          "text": "Okay, this is all I can teach you. I know it's sad but it is time to say good bye. Well take care if yourself and Good luck my friend!\r\n\r\n#fUI/UIWindow.img/QuestIcon/4/0#\r\n#v2010000# 3 #t2010000#\r\n#v2010009# 3 #t2010009#\r\n\r\n#fUI/UIWindow.img/QuestIcon/8/0# 10 exp",
          "choices": [
            {"text": "Previous", "nextState": "presentAnnouncement"},
            {"text": "Next", "nextState": "checkAndReward"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "checkAndReward",
        "type": "genericAction",
        "genericAction": {
          "operations": [],
          "outcomes": [
            {
              "conditions": [
                {"type": "questStatus", "operator": "=", "value": "3", "referenceId": "1021"}
              ],
              "nextState": "errorAlreadyCompleted"
            },
            {
              "conditions": [
                {"type": "inventorySpace", "operator": ">=", "value": "1", "referenceId": "2010000"},
                {"type": "inventorySpace", "operator": ">=", "value": "1", "referenceId": "2010009"}
              ],
              "nextState": "giveRewards"
            },
            {
              "conditions": [],
              "nextState": "inventoryFull"
            }
          ]
        }
      },
      {
        "id": "errorAlreadyCompleted",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "send_message", "params": {"messageType": "POP_UP", "message": "Unknown Error"}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": null}
          ]
        }
      },
      {
        "id": "giveRewards",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "award_exp", "params": {"amount": "10"}},
            {"type": "award_item", "params": {"itemId": "2010000", "quantity": "3"}},
            {"type": "award_item", "params": {"itemId": "2010009", "quantity": "3"}},
            {"type": "complete_quest", "params": {}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": null}
          ]
        }
      },
      {
        "id": "inventoryFull",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "send_message", "params": {"messageType": "POP_UP", "message": "Your inventory is full"}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": null}
          ]
        }
      }
    ]
  }
}
