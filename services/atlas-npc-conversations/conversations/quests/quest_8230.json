{
  "questId": 8230,
  "npcId": 9201096,
  "questName": "Stemming the Tide",
  "startStateMachine": {
    "startState": "askAccept",
    "states": [
      {
        "id": "askAccept",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendAcceptDecline",
          "text": "Hey, traveler! I need your help. A great threat is about to endanger the folks down there at the New Leaf City, the way I can see it right now. These creatures roaming around here suddenly... That can be no good. Care if you listen to what I have to say?",
          "choices": [
            {"text": "Accept", "nextState": "startAndExplain"},
            {"text": "Decline", "nextState": "decline"},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "decline",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendOk",
          "text": "Okay, then. See you around.",
          "choices": [
            {"text": "Ok", "nextState": null},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "startAndExplain",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "start_quest", "params": {}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": "explanation"}
          ]
        }
      },
      {
        "id": "explanation",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendOk",
          "text": "That's the thing: the Twisted Masters, great figures that currently holds seize of the Crimsonwood Keep, have planned a large-scale attack to the New Leaf City, that may be happening on the next few days. I can't just stay here observing while they prepare for this attack. However, I can't just leave this position, I must keep an eye on their moves at all costs. There's where you enter: go find Lukan, knight of the past Crimsonwood Keep, that is currently wandering around the woods, and receive from him further orders, he knows what to do.",
          "choices": [
            {"text": "Ok", "nextState": null},
            {"text": "Exit", "nextState": null}
          ]
        }
      }
    ]
  },
  "endStateMachine": {
    "startState": "checkCompletion",
    "states": [
      {
        "id": "checkCompletion",
        "type": "genericAction",
        "genericAction": {
          "operations": [],
          "outcomes": [
            {
              "conditions": [
                {"type": "item", "operator": ">=", "value": "1", "referenceId": "3992041"}
              ],
              "nextState": "completeQuest"
            },
            {
              "conditions": [
                {"type": "questStatus", "operator": "=", "value": "2", "referenceId": "8223"}
              ],
              "nextState": "lostKey"
            },
            {
              "conditions": [],
              "nextState": "needToComplete"
            }
          ]
        }
      },
      {
        "id": "completeQuest",
        "type": "genericAction",
        "genericAction": {
          "operations": [
            {"type": "complete_quest", "params": {}}
          ],
          "outcomes": [
            {"conditions": [], "nextState": "success"}
          ]
        }
      },
      {
        "id": "success",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendOk",
          "text": "Ah, you did accomplish the task I handed to you. Nicely done, now those guys are busy recovering from this offensive. Now, remember: #bthat key must be used to access#k the Inner Sanctum inside the Keep. Hold that with you at all times if you ever want to enter there.",
          "choices": [
            {"text": "Ok", "nextState": null},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "lostKey",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendOk",
          "text": "You completed the mission but lost the key? That's bad, you NEED this key to enter the inner rooms of the Keep. Check out there with Lukan what you should be doing next, we need you inside the Keep.",
          "choices": [
            {"text": "Ok", "nextState": null},
            {"text": "Exit", "nextState": null}
          ]
        }
      },
      {
        "id": "needToComplete",
        "type": "dialogue",
        "dialogue": {
          "dialogueType": "sendOk",
          "text": "The folks back there on the city are counting on you on this one. Please hurry up.",
          "choices": [
            {"text": "Ok", "nextState": null},
            {"text": "Exit", "nextState": null}
          ]
        }
      }
    ]
  }
}
